YUI.add("hermes-template-signup-footer",function(n,e){var l=n.Template.Handlebars.revive({1:function(n,e,l,i,a){return"mini-footer"},3:function(n,e,l,i,a){return"large-footer"},5:function(n,e,l,i,a){return"has-logo"},7:function(n,e,l,i,a){return'\t\t<div class="close-x"></div>\n'},9:function(n,e,l,i,a){var t,o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return null!=(t=(o(l,"isFlipped")||e&&o(e,"isFlipped")||n.hooks.helperMissing).call(null!=e?e:n.nullContext||{},"mini-signup-footer-avatar",{name:"isFlipped",hash:{},fn:n.program(10,a,0),inverse:n.program(12,a,0),data:a,loc:{start:{line:6,column:2},end:{line:10,column:16}}}))?t:""},10:function(n,e,l,i,a){var t,o=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'\t\t\t<div class="avatar person" style="background-image: url('+n.escapeExpression("function"==typeof(t=null!=(t=o(l,"buddyIcon")||(null!=e?o(e,"buddyIcon"):e))?t:n.hooks.helperMissing)?t.call(null!=e?e:n.nullContext||{},{name:"buddyIcon",hash:{},data:a,loc:{start:{line:7,column:59},end:{line:7,column:72}}}):t)+')"></div>\n'},12:function(n,e,l,i,a){return'\t\t\t<div class="logo"></div>\n'},14:function(n,e,l,i,a){return'\t\t<div class="logo"></div>\n'},16:function(n,e,l,i,a){return"mini"},18:function(n,e,l,i,a){return"large"},20:function(n,e,l,i,a){return"miniSignupFooterSignupClick"},22:function(n,e,l,i,a){return"signupFooterSignupClick"},24:function(n,e,l,i,a){return"miniSignupFooterSigninClick"},26:function(n,e,l,i,a){return"signupFooterSigninClick"},compiler:[8,">= 4.3.0"],main:function(n,e,l,i,a){var t,o,r=null!=e?e:n.nullContext||{},s=n.hooks.helperMissing,u=n.escapeExpression,c=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="signup-footer '+(null!=(t=c(l,"if").call(r,null!=e?c(e,"isMiniFooter"):e,{name:"if",hash:{},fn:n.program(1,a,0),inverse:n.program(3,a,0),data:a,loc:{start:{line:1,column:26},end:{line:1,column:84}}}))?t:"")+" "+(null!=(t=(c(l,"isNotFlipped")||e&&c(e,"isNotFlipped")||s).call(r,"mini-signup-footer-avatar",{name:"isNotFlipped",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:1,column:85},end:{line:1,column:155}}}))?t:"")+'">\n'+(null!=(t=(c(l,"isFlipped")||e&&c(e,"isFlipped")||s).call(r,"mini-signup-footer-cancellable",{name:"isFlipped",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:1},end:{line:4,column:15}}}))?t:"")+(null!=(t=c(l,"if").call(r,null!=e?c(e,"isProfilePage"):e,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.program(14,a,0),data:a,loc:{start:{line:5,column:1},end:{line:13,column:8}}}))?t:"")+'\t<p class="truncate">'+u("function"==typeof(o=null!=(o=c(l,"message")||(null!=e?c(e,"message"):e))?o:s)?o.call(r,{name:"message",hash:{},data:a,loc:{start:{line:14,column:21},end:{line:14,column:32}}}):o)+'</p>\n\t<a href="/signup" class="'+(null!=(t=c(l,"if").call(r,null!=e?c(e,"isMiniFooter"):e,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.program(18,a,0),data:a,loc:{start:{line:15,column:26},end:{line:15,column:70}}}))?t:"")+' butt" data-track="'+(null!=(t=c(l,"if").call(r,null!=e?c(e,"isMiniFooter"):e,{name:"if",hash:{},fn:n.program(20,a,0),inverse:n.program(22,a,0),data:a,loc:{start:{line:15,column:89},end:{line:15,column:174}}}))?t:"")+'">'+u((c(l,"intlMessage")||e&&c(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"sohp.SIGN_UP_WITH_YAHOO"},data:a,loc:{start:{line:15,column:176},end:{line:15,column:226}}}))+'</a>\n\t<p class="signin">or <a href="/signin" data-track="'+(null!=(t=c(l,"if").call(r,null!=e?c(e,"isMiniFooter"):e,{name:"if",hash:{},fn:n.program(24,a,0),inverse:n.program(26,a,0),data:a,loc:{start:{line:16,column:52},end:{line:16,column:137}}}))?t:"")+'">'+u((c(l,"intlMessage")||e&&c(e,"intlMessage")||s).call(r,{name:"intlMessage",hash:{intlName:"common.SIGN_IN"},data:a,loc:{start:{line:16,column:139},end:{line:16,column:180}}}))+"</a><p>\n</div>\n"},useData:!0}),i={};n.Array.each([],function(e){var l=n.Template.get("hermes/"+e);l&&(i[e]=l)}),n.Template.register("hermes/signup-footer",function(e,a){return a=a||{},a.partials=a.partials?n.merge(i,a.partials):i,l(e,a)})},"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("signup-footer-view",function(e,t){"use strict";e.namespace("Views").SignUpFooterView=e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){this.set("pageNSID",e.nsid),this.set("groupID",e.groupId),this.set("pageType",void 0!==e.pageType?e.pageType:"profile"),this.set("messageIntlName",e.messageIntlName),this.set("query",e.searchTerm),e.isMobile||!this.appContext.flipper.isFlipped("enable-mini-sign-up-footer")||this.appContext.getViewer().signedIn||"en-US"!==this.appContext.lang?this.set("showPopup",!1):this.set("showPopup",!0),this.appContext.flipper.isFlipped("enable-large-sign-up-footer")?(this.set("modalType",""),this.set("beaconPrefix","signupFooter")):(this.set("modalType","mini"),this.set("beaconPrefix","miniSignupFooter"))},loadState:function(){var t=this;return this.get("showPopup")?"profile"===this.get("pageType")?this.appContext.getModel("person-models",this.get("pageNSID")).then(function(e){t.set("personModel",e)}):"group"===this.get("pageType")?this.appContext.getModel("group-info-models",this.get("groupID")).then(function(e){t.set("groupModel",e)}):e.Promise.resolve():e.Promise.resolve()},buildContainer:function(){var t={isProfilePage:"profile"===this.get("pageType")||"group"===this.get("pageType")};return this.get("showPopup")?("profile"===this.get("pageType")?(t.buddyIcon=this.appContext.flipper.isFlipped("mini-signup-footer-avatar")?this.get("personModel").getValue("buddyicon").default:"",t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE",username:e.flutil.unescape(this.get("personModel").getValue("displayname"))})):"explore"===this.get("pageType")?t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_EXPLORE"}):"group"===this.get("pageType")?(t.buddyIcon=this.appContext.flipper.isFlipped("mini-signup-footer-avatar")?this.get("groupModel").getValue("group").getValue("bestIconURL"):"",t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE",username:e.flutil.unescape(this.get("groupModel").getValue("group").getValue("title"))})):t.message=this.intlMessage({intlName:"growth.MINI_SIGNUP_FOOTER_MESSAGE_SEARCH",query:this.get("query")}),"mini"===this.get("modalType")&&(t.isMiniFooter=!0),this.setContainerWithTemplate("signup-footer",t),this):this},activate:function(){this.get("showPopup")&&(this.initialScroll=e.config.win.pageYOffset,this.signupFooterNode=this.get("container").one(".signup-footer"),this.signupFooterHeight=parseInt(this.signupFooterNode.getStyle("height"),10),this.signupFooterOffset=parseInt(this.signupFooterNode.getStyle("bottom"),10),this.registerEventHandler(e.globalEvents.subscribe("window:scroll:nothrottle",this.handleScroll.bind(this))),this.appContext.flipper.isFlipped("mini-signup-footer-cancellable")&&this.get("container").one(".close-x")&&this.registerEventHandler(this.get("container").one(".close-x").on("click",this.handleCancelClick.bind(this))),this.footerContainer=e.one(".footer-full-view"),this.footer=this.footerContainer?e.one("footer.foot"):null)},showMiniSignupFooter:function(){var t,i=e.StorageHelper.getItem("miniSignupFooterSeen");return i?(i=e.moment(i,"x"),e.moment().subtract(1,"days")>i&&(t=!0)):t=!0,t},handleCancelClick:function(i){this.signupFooterNode&&(this.signupFooterNode.removeClass("show"),this.signupFooterNode.removeClass("footer-bottom")),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"CancelClick"),this.set("showPopup",!1)},handleScroll:function(i){if(this.get("showPopup")){var o,s=e.config.win.pageYOffset-this.initialScroll,n=s-200;Math.abs(s)>200||s<=0?Math.abs(this.signupFooterHeight-n)>=0&&s>0&&(this.signupFooterNode.hasClass("show")||(this.signupFooterNode.addClass("show"),this.set("anchoredToWindowCorner",!0),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"Show"))):this.signupFooterNode.hasClass("show")&&!this.appContext.flipper.isFlipped("mini-signup-footer-cancellable")&&(this.signupFooterNode.removeClass("show"),e.rapidTracker.beacon(t,this.get("beaconPrefix")+"Hide")),o=e.config.win.pageYOffset+this.appContext.viewportData.getHeight()-this.signupFooterOffset,"none"!==this.footerContainer.getComputedStyle("display")&&o>=this.footer.getY()?this.signupFooterNode.hasClass("footer-bottom")||(this.signupFooterNode.addClass("footer-bottom"),this.set("anchoredToWindowCorner",!1)):this.get("anchoredToWindowCorner")||(this.signupFooterNode.removeClass("footer-bottom"),this.set("anchoredToWindowCorner",!0))}}},{ATTRS:{isActiveViewAgnostic:{value:!0}}})},"@VERSION@",{requires:["flickr-view","hermes-template-signup-footer","storage-helper","moment","flutil"],optionalRequires:["global-events"],langBundles:["common","sohp","growth"]});